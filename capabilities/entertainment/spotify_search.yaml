fulcrum: "1.0"
name: spotify_search
description: Search Spotify for tracks, artists, albums, playlists, and podcasts. Requires OAuth2 (client credentials flow).

schema:
  input:
    type: object
    properties:
      query:
        type: string
        description: Search query (supports field filters like artist:, album:, track:, year:, genre:)
        examples:
          - "Bohemian Rhapsody"
          - "artist:Queen"
          - "album:A Night at the Opera"
          - "genre:rock year:1975"
      type:
        type: string
        description: Comma-separated types to search
        default: track,artist,album
        examples:
          - track
          - artist,album
          - track,artist,album,playlist,show,episode
      market:
        type: string
        description: ISO 3166-1 alpha-2 country code for market-specific results
        examples:
          - US
          - FI
          - NL
      limit:
        type: integer
        description: Number of results per type (max 50)
        default: 20
        maximum: 50
      offset:
        type: integer
        description: Pagination offset
        default: 0
      include_external:
        type: string
        description: Include external audio content
        enum: [audio]
    required: [query]
  output:
    type: object
    properties:
      tracks:
        type: object
        properties:
          items:
            type: array
            items:
              type: object
              properties:
                id:
                  type: string
                name:
                  type: string
                artists:
                  type: array
                  items:
                    type: object
                    properties:
                      name:
                        type: string
                album:
                  type: object
                  properties:
                    name:
                      type: string
                    release_date:
                      type: string
                duration_ms:
                  type: integer
                preview_url:
                  type: string
                external_urls:
                  type: object
                  properties:
                    spotify:
                      type: string
      artists:
        type: object
        properties:
          items:
            type: array
      albums:
        type: object
        properties:
          items:
            type: array

providers:
  primary:
    service: spotify
    cost_per_call: 0.0
    timeout: 10
    config:
      endpoint: https://api.spotify.com/v1/search
      method: GET
      param_map:
        query: q
        type: type
        market: market
        limit: limit
        offset: offset
        include_external: include_external

cache:
  strategy: semantic
  ttl: 3600  # 1 hour

auth:
  required: true
  type: oauth2
  flow: client_credentials
  token_url: https://accounts.spotify.com/api/token
  client_id_key: SPOTIFY_CLIENT_ID
  client_secret_key: SPOTIFY_CLIENT_SECRET
  scopes: []
  notes: |
    Create app at https://developer.spotify.com/dashboard
    Uses client_credentials flow (no user login required)
    Token auto-refreshes every hour

metadata:
  category: entertainment
  tags: [music, spotify, search, tracks, artists, albums, podcasts]
  cost_category: free
  execution_time: fast
  read_only: true
  rate_limit:
    default: unlimited
  notes: |
    Free with Spotify Developer account (no premium required)
    Preview URLs (30s clips) available for most tracks
    Full playback requires Spotify Premium + user auth
